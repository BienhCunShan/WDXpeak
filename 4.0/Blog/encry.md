# 加密相关

#HTTPS 中的加密算法相关概念

一个明文在相同的密码算法和不同的密钥计算下会产生不同的密文。很多知名的密码算法都是公开的，密钥才是决定密文是否安全的重要参数，通常密钥越长，破解的难度越大，比如一个 8 位的密钥最多有 256 种情况，使用穷举法，能非常轻易的破解。知名的 DES 算法使用 56 位的密钥，目前已经不是一种安全的加密算法了，主要还是因为 56 位的密钥太短，在数小时内就可以被破解。密钥分为对称密钥与非对称密钥。

对称密钥又称为共享密钥加密，对称密钥在加密和解密的过程中使用的密钥是相同的，常见的对称加密算法有DES、3DES、AES、RC5、RC6。对称密钥的优点是计算速度快，但是它也有缺点，密钥需要在通讯的两端共享，让彼此知道密钥是什么对方才能正确解密，如果所有客户端都共享同一个密钥，那么这个密钥就像万能钥匙一样，可以凭借一个密钥破解所有人的密文了，如果每个客户端与服务端单独维护一个密钥，那么服务端需要管理的密钥将是成千上万，这会给服务端带来噩梦。

非对称密钥，又称为公开密钥加密。服务端会生成一对密钥，一个私钥保存在服务端，仅自己知道，另一个是公钥，公钥可以自由发布供任何人使用。客户端的明文通过公钥加密后的密文需要用私钥解密。非对称密钥在加密和解密的过程的使用的密钥是不同的密钥，加密和解密是不对称的，所以称之为非对称加密。与对称密钥加密相比，非对称加密无需在客户端和服务端之间共享密钥，只要私钥不发给任何用户，即使公钥在网上被截获，也无法被解密，仅有被窃取的公钥是没有任何用处的。常见的非对称加密有 RSA，非对称加解密的过程： 服务端生成配对的公钥和私钥 私钥保存在服务端，公钥发送给客户端 客户端使用公钥加密明文传输给服务端 服务端使用私钥解密密文得到明文

数字签名就是用于验证传输的内容是不是真实服务器发送的数据，发送的数据有没有被篡改过，它就干这两件事，是非对称加密的一种应用场景。不过他是反过来用私钥来加密，通过与之配对的公钥来解密。 第一步：服务端把报文经过 Hash 处理后生成摘要信息，摘要信息使用私钥加密之后就生成签名，服务器把签名连同报文一起发送给客户端。 signature1 第二步：客户端接收到数据后，把签名提取出来用公钥解密，如果能正常的解密出来 Digest2，那么就能确认是对方发的。 第三步：客户端把报文 Tex t提取出来做同样的 Hash 处理，得到的摘要信息 Digest1，再与之前解密出来的 Digist2 对比，如果两者相等，就表示内容没有被篡改，否则内容就是被人改过了。因为只要文本内容哪怕有任何一点点改动都会 Hash 出一个完全不一样的摘要信息出来。

如何保证你现在使用的公钥就是真实服务器发给你的呢？我们就用数字证书来解决这个问题。数字证书一般由数字证书认证机构颁发，证书里面包含了真实服务器的公钥和网站的一些其他信息，数字证书机构用自己的私钥加密后发给浏览器，浏览器使用数字证书机构的公钥解密后得到真实服务器的公钥。这个过程是建立在被大家所认可的证书机构之上得到的公钥，所以这是一种安全的方式。



